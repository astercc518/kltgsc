# 开发计划 (Development Plan)

本项目遵循“由简入深”的原则，将开发过程分为多个阶段（Stage）。每完成一个阶段，都应交付可用的软件版本。针对 **1000+ 账号** 的高并发与自动化需求，我们将基础设施建设（队列、代理、风控）前置。

## Stage 1: 基础框架搭建 (Infrastructure) [Current]
*   **目标**: 跑通前后端流程，验证开发环境。
*   **Backend**: 初始化 FastAPI，集成 SQLModel (SQLite)，配置 CORS。
*   **Frontend**: 初始化 React + Vite + Ant Design，搭建 Layout。
*   **Integration**: 确保前端能调用后端 `/health` 接口。
*   **交付物**: Hello World 级别的 Web 应用。

## Stage 2: 核心资源管理 (Core Resource Mgmt)
*   **目标**: 建立支持大规模账号运行的基础数据库与管理界面。
*   **代理池 (Proxy Pool)**:
    *   后端: 代理导入接口 (txt), 代理连通性检测任务, 代理表设计。
    *   前端: 代理管理表格，上传代理，查看存活状态。
*   **账号仓库 (Account Vault)**:
    *   后端: Session 文件批量上传，自动解析参数。账号表设计 (关联 Proxy ID)。
    *   前端: 账号列表（分页），批量导入弹窗，状态指示灯。
*   **交付物**: 能够导入 100+ 个代理和账号，并手动点击“检查存活”。

## Stage 3: 任务调度与并发控制 (Scheduler & Queue)
*   **目标**: 引入异步任务队列，解耦 Web 请求与 TG 操作，支持并发。
*   **架构升级**:
    *   部署 Redis。
    *   集成 Celery 或 Python `asyncio.Queue` (简单版) / ARQ。
*   **功能实现**:
    *   **一键验活**: 前端点击“全部检查”，后端生成 N 个异步任务，并发检查账号状态。
    *   **并发限制**: 实现全局信号量 (Semaphore) 限制同时在线的 TG 客户端数量。
*   **交付物**: 可以在后台看着日志通过，同时检查 50 个账号的状态而不阻塞主线程。

## Stage 4: 基础采集与营销 (Scraping & Basic Marketing)
*   **目标**: 实现最核心的业务价值。
*   **采集**:
    *   指定账号加入群组 -> 获取成员 -> 存入数据库 (`TargetUser` 表)。
    *   过滤逻辑：去重、活跃时间筛选。
*   **私信群发**:
    *   创建“发送任务”：选择源账号列表、话术、目标用户列表。
    *   **基础风控**: 任务执行时加入随机延迟 (Sleep 10-60s)。
*   **交付物**: 能够采集一个群的用户，并使用 5 个账号对其中 20 人发送 Hello。

## Stage 5: 高级风控与自动化 (Advanced Anti-Ban)
*   **目标**: 保护账号安全，实现无人值守。
*   **指纹系统**:
    *   为每个账号生成并持久化 `device_model`, `system_version` 等参数。
*   **熔断机制**:
    *   捕获 `FloodWait`, `PeerFlood` 异常，自动暂停该账号任务并标记“冷却中”。
*   **自动化养号**:
    *   开发“养号任务”：随机浏览频道、随机群内发表情。
*   **交付物**: 系统能自动处理报错，账号被封或受限时自动停止损耗。

## Stage 6: AI 智能营销 (AI Marketing)
*   **目标**: 提升转化率。
*   **AI 集成**:
    *   对接 LLM API。
    *   实现“智能回复”功能：收到私信 -> AI 生成 -> 发送。
*   **炒群脚本**:
    *   多账号配合剧本（A提问，B回答）。
*   **交付物**: 可以在群里看到“自己人”在聊得火热。

## Stage 7: CRM 客户管理 (CRM & Inbox)
*   **目标**: 流量承接与转化。
*   **聚合聊天**:
    *   WebSocket 实时推送新消息到 Web 端。
    *   统一回复界面。
*   **线索管理**:
    *   意向客户打标、归档。
*   **交付物**: 客服人员只需盯着一个网页即可回复所有 TG 号的消息。

## Stage 8: 数据看板与运维 (Dashboard & Ops)
*   **目标**: 宏观监控。
*   **统计**: 每日发送量、成功率、账号存活率趋势图。
*   **日志**: 详细的操作日志审计。

## Stage 9: 高级转化与增长 (Growth & Conversion Optimization)
*   **目标**: 从“主动骚扰”转向“被动引流”，最大化转化率。
*   **被动引流**:
    *   群组关键词监控 (Monitor)。
    *   多账号配合演戏 (Theater Script) - 引导用户主动私信。
*   **私域构建**:
    *   批量拉人 (Inviter) - 将采集用户拉入自建群。
*   **AI SDR**:
    *   AI 意图识别与自动打标。
    *   高意向客户强提醒。
*   **交付物**: 实现关键词自动触发炒群脚本，AI 自动识别高意向客户并通知人工。
