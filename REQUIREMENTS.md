# Telegram 群控平台需求分析

## 1. 项目概述
本项目旨在开发一个 **高度自动化** 的 Telegram 账号批量管理与自动化操作平台（群控系统）。主要用于社群运营、自动化营销及消息管理。核心目标是支持 **1000+ 账号** 的稳定运行，最大程度减少人工干预，并通过技术手段降低账号风控风险。

## 2. 核心功能模块

### 2.1 高级账号管理与批量自动化 (Advanced Account Automation)
*   **批量导入与初始化**：
    *   **多格式支持**：批量导入 `.session` 文件、Tdata 文件夹、或 `手机号+API Hash` 列表。
    *   **自动化初始化流程 (One-Click Onboarding)**：
        1.  导入账号。
        2.  **自动绑定代理**：从代理池自动分配独立 IP。
        3.  **自动验活**：检查 Session 有效性。
        4.  **自动完善资料**：随机从素材库选择头像、昵称、Bio 简介进行设置。
        5.  **自动设置 2FA**：如未设置，自动生成并记录 2FA 密码。
*   **全自动注册 (Auto Registration)**：
    *   **流水线作业**：自动提取 ISP 代理 -> 接码 (SMS-Activate) -> 注册 -> 养号。
    *   **风控对抗**：拟人化操作延迟，随机设备指纹，注册后自动静默养号。
*   **代理池管理 (Proxy Pool)**：
    *   **批量导入**：支持文本格式 (`ip:port:user:pass`) 批量导入代理。
    *   **智能分配**：自动为新账号分配空闲代理。
    *   **健康巡检**：定时检测代理连通性，失效自动标记并尝试更换（需配置策略）。
*   **账号生命周期管理**：
    *   **状态监控**：后台定时轮询检测账号存活、Spamblock 状态。
    *   **异常处理**：发现封号/受限自动标记并归档，避免任务分配给无效账号。

### 2.2 采集与数据获取 (Scraping)
*   **群成员采集**：
    *   输入目标群组链接，采集群内成员信息（ID、Username、昵称）。
    *   **精准过滤**：
        *   过滤管理员/机器人。
        *   按“最近上线时间”过滤（如：只采集 3 天内上线的活跃用户）。
        *   去除重复数据。
*   **群组搜索**：关键词搜索相关群组链接。

### 2.3 基础营销与交互 (Basic Marketing)
*   **批量拉人 (Inviter)**：
    *   将采集到的用户批量拉入指定群组/频道。
    *   限制策略：单号单日拉人上限控制，失败自动跳过。
*   **消息群发 (Mass DM / Sender)**：
    *   **私信群发**：向采集的用户列表发送私信。
    *   **群组群发**：向加入的群组发送广告/通知。
    *   **内容管理**：支持文本、图片、链接、转发消息。支持“话术轮询”和“随机字符”以规避风控。
*   **自动加群**：批量加入指定链接的群组。

### 2.4 高级营销功能 (Advanced Marketing)
*   **AI 智能炒群 (AI Auto-Chat)**：
    *   **角色扮演 (Roleplay)**：集成 LLM (如 OpenAI/Claude/LocalLLM)，为不同账号设定独立人设（性格、语气、职业）。
    *   **话题引导**：根据预设剧本或实时热点，多账号配合发起并维持群组讨论，营造活跃氛围。
    *   **智能接话**：识别群内上下文，自然介入对话，避免生硬回复。
*   **群组广告增强 (Group Ads)**：
    *   **关键词监控插播**：实时监控目标群聊内容，检测到特定关键词（如“推荐”、“哪里买”）时，触发特定账号发送软广。
    *   **定时循环广播**：在自有群或管理群中，按设定时间间隔循环发送置顶广告或普通消息。
    *   **软广植入**：在 AI 炒群对话中，自然地提及推广产品或链接。

### 2.5 客户关系管理 (CRM)
*   **线索管理 (Leads)**：
    *   **自动录入**：将采集到的活跃用户、回复过私信的用户自动转为“线索”。
    *   **标签系统**：手动或自动给用户打标签（如“高意向”、“已询价”、“垃圾粉”）。
    *   **跟进记录**：记录每个客户的所有聊天历史、操作记录（已拉群、已私信）。
*   **聚合聊天 (Unified Inbox)**：
    *   **多号同屏**：在一个界面查看和回复所有受控账号收到的私信。
    *   **快捷回复**：预设常用语库，一键发送。
    *   **翻译助手**：集成自动翻译功能，方便跨语言沟通。

### 2.6 自动化与养号 (Automation & Warm-up)
*   **智能养号策略**：
    *   **新号预热**：针对新导入账号，执行 3-7 天的渐进式活跃计划（第1天仅登录浏览，第2天加1个群，第3天发1条消息...）。
    *   **日常活跃**：控制闲置账号进行随机行为（浏览频道、点赞、加入公开群、随机在线时长），保持账号权重。
    *   **账号互聊**：控制账号之间随机互发消息，模拟正常社交。
*   **自动回复**：
    *   关键词触发自动回复。
    *   新粉丝/私信自动打招呼。

### 2.7 任务调度与高级风控 (Scheduler & Anti-Ban)
*   **大规模并发调度**：
    *   支持 1000+ 账号的任务队列管理。
    *   **资源分组**：将账号按业务线或权重分组，独立调度。
    *   **错峰执行**：避免所有账号同一时间上线，模拟真实用户时区分布。
*   **高级风控策略 (Anti-Ban Strategy)**：
    *   **指纹伪装 (Device Fingerprinting)**：每个 Session 绑定固定的设备指纹 (Model, System Version)。
    *   **行为拟人化**：随机操作间隔、工作时间控制（夜间休眠）。
    *   **阈值控制**：严格限制单号操作配额，根据账号权重动态调整。
    *   **异常熔断**：检测到 FloodWait/Spamblock 立即停止并在后台报警。
    *   **IP 隔离**：强制检查代理连通性，无代理不上线。

### 2.8 高级增长与转化 (Growth & Conversion)
*   **被动引流策略 (Inbound Traffic)**：
    *   **关键词监控 (Keyword Monitor)**：实时监听目标群组，捕捉高价值关键词（如“推荐”、“购买”、“价格”）。
    *   **多号配合演戏 (Roleplay Theatre)**：
        *   当监控到关键词时，自动调度“托”账号（Shill Account）介入。
        *   账号 A 提问，账号 B 推荐主号（Official Account），账号 C 附和，制造舆论信任。
*   **私域构建 (Inviter)**：
    *   **批量拉人**：将采集到的精准活跃用户批量拉入自建的中转群/频道。
    *   **群清洗**：在中转群内通过 Bot 和置顶消息进行内容培育，引导用户私信主号。
*   **AI 销售代表 (AI SDR)**：
    *   **意图识别**：AI 自动分析用户私信意图（询价/投诉/闲聊），并自动打标。
    *   **引导式对话**：配置 AI 引导话术，不直接报价，而是引导用户说出需求和预算。
    *   **人工介入强提醒**：当识别到“高意向”信号时，WebSocket 强推送提醒真人销售介入。

### 2.9 账号分级架构 (Tiered Architecture)
*   **账号金字塔**：
    *   **Tier 1 (Official/Premium)**：主客服号，开通会员，资料完善，不进行风险操作，只被动承接流量。
    *   **Tier 2 (Shill/Support)**：托号/氛围组，长期养号，模拟真人，负责群聊互动、引导。
    *   **Tier 3 (Disposable)**：消耗号，负责高频采集、拉人、私信群发，随时准备被封。
*   **权限隔离**：不同层级账号拥有不同的任务权限（如 Tier 1 禁止执行 Mass DM）。

## 3. 非功能性需求

*   **性能**：支持数百/上千个账号同时在线或轮询执行任务。
*   **稳定性**：任务中断后支持断点续传（如网络波动）。
*   **安全性**：Session 数据加密存储，操作日志记录。
*   **易用性**：提供 Web 可视化管理后台，支持“一键式”批量操作。

## 4. 建议技术栈

*   **后端**：
    *   语言：Python (推荐) 或 Go。
    *   核心库：**Telethon** 或 **Pyrogram** (最成熟的 MTProto 协议实现)。
    *   Web 框架：FastAPI 或 Django/Flask。
    *   任务队列：Celery + Redis。
    *   数据库：PostgreSQL 或 MySQL。
    *   **AI/LLM**：LangChain (用于构建 AI 流程), OpenAI API / Anthropic API / Ollama (本地部署)。
*   **前端**：
    *   React / Vue.js + Ant Design / Element Plus。
*   **部署**：
    *   Docker + Docker Compose。

## 5. 开发阶段规划 (Roadmap)

1.  **Phase 1 (MVP)**: 账号导入、代理绑定、基础的群成员采集、简单的文本私信群发。
2.  **Phase 2**: 批量拉人功能、任务队列系统、Web 管理后台雏形、防封策略优化。
3.  **Phase 3**: 养号脚本、自动回复、AI 炒群基础版（预设话术）、群组关键词监控。
4.  **Phase 4**: CRM 系统（聚合聊天、线索管理）、完整 AI 智能炒群、高级数据统计。
